<!doctype html>
<html lang="de">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Admin - Video Upload</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <header>
            <h1>Admin Panel</h1>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="videos.html">Videos</a></li>
                    <li><a href="admin.html">Login</a></li>
                    <li><a href="about.html">Über mich</a></li>
                    <li><a href="contact.html">Kontakt</a></li>
                </ul>
            </nav>
        </header>

        <main>
            <section>
                <h2>Video hinzufügen</h2>
                <form id="video-form" action="/admin/upload" method="POST">
                    <label for="youtube-url">YouTube-URL:</label><br />
                    <input
                        type="text"
                        id="youtube-url"
                        name="youtube-url"
                        placeholder="https://www.youtube.com/watch?v=..."
                    /><br /><br />
                    <button type="submit">Video hochladen</button>
                </form>
                <div id="upload-status"></div>
            </section>
        </main>

        <footer>
            <p>&copy; 2023 Mein Name</p>
        </footer>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            const videoForm = document.getElementById("video-form");
            const uploadStatus = document.getElementById("upload-status");

            videoForm.addEventListener("submit", (event) => {
                event.preventDefault(); // Prevent default form submission

                const youtubeUrl = document.getElementById("youtube-url").value;
                const videoId = youtubeUrl.split("v=")[1]; // Extract video ID from URL

                // Check if the video ID is valid
                if (videoId) {
                    uploadStatus.textContent = "Video wird hochgeladen...";
                    fetch("/admin/upload", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ videoId: videoId }),
                    })
                        .then((response) => {
                            if (response.ok) {
                                uploadStatus.textContent =
                                    "Video erfolgreich hochgeladen!";
                            } else {
                                uploadStatus.textContent =
                                    "Fehler beim Hochladen!";
                            }
                        })
                        .catch((error) => {
                            console.error("Error:", error);
                            uploadStatus.textContent = "Fehler beim Hochladen!";
                        });
                } else {
                    uploadStatus.textContent = "Ungültige YouTube-URL!";
                }
            });
        </script>
    </body>
</html>
